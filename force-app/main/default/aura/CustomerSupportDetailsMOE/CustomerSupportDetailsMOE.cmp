<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction"
                access="global" controller='ET_BusinessCommunityController' extends="c:ET_MOE_BilingualCommunity">
    <aura:attribute name="objectApiName" type="String" />
    <!-- Handling events -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler event="c:ServiceRequestEvent" action="{!c.handleApplicationEvent}" />
    
    <!-- Registering events -->
    <aura:registerEvent name="appEvent" type="c:MyBusinessDetailPageEvent"/>
    
    <!-- Attributes to calculate Dashboard Values-->
    <aura:attribute name="newCases" type="Integer" default="0" />
    <aura:attribute name="escalatedCases" type="Integer" default="0" />
    <aura:attribute name="onHoldCases" type="Integer" default="0" />
    <aura:attribute name="invalidCases" type="Integer" default="0" />
    <aura:attribute name="closedCases" type="Integer" default="0" />
    <aura:attribute name="requestCount" type="Integer" default="0" />
    <aura:attribute name="finalListToAdd" type="list" />
    <aura:attribute name="customerSupportDashboard" type="Boolean" default="true" />
    <aura:attribute name="createRequest" type="Boolean" />
    <aura:attribute name="reqHistory" type="Boolean" />
    <aura:attribute name="escalation" type="Boolean" />
    <aura:attribute name="feedback" type="Boolean" />
    
    <!-- Attributes to show Case Table-->
    <aura:attribute name="showCaseTable" type="Boolean" /> 
    <aura:attribute name="newCase" type="Boolean" /> 
    <aura:attribute name="clickedDashboard" type="String" default=""/> 
    <aura:handler event="c:ETST_sendDataEvent" action="{!c.closeactionevt}"/>
    <!--Attribute to get the selected case filters on All cases Page--> 
    <aura:attribute name="caseRecord" type="case"  default="{'sobjectType':'Case',
                                                            'Status':'New'
                                                            }"/> 
    
    <!-- Attributes to store search filter values -->
    <aura:attribute name="caseNumber" type="String" default=""/> 
    <aura:attribute name="statusFilter" type="String" default=""/>
    <aura:handler event="force:refreshView" action="{!c.doInit}"/>
    <aura:attribute name="selectedLookUpSalesAgreementRecord" type="sObject" />
    <aura:attribute name="selectedLookUpResourcesRecord" type="sObject" />
    <aura:attribute name="selectedLookUpVehiclesRecord" type="sObject" />
    <aura:attribute name="selectedLookUpStudentRecord" type="sObject" />
    <aura:attribute name="searchText" type="string"/>
    
    <!-- Attributes to handle filter search -->
    <!-- <aura:handler name="change" value="{!v.caseRecord}" action="{!c.handleSearch}"/> -->
    <aura:handler name="change" value="{!v.caseNumber}" action="{!c.handleSearch}"/>
    <aura:handler name="change" value="{!v.statusFilter}" action="{!c.handleSearch}"/>
    <aura:handler name="change" value="{!v.selectedsAgreementRecord}" action="{!c.handleSearch}"/>
    <aura:handler name="change" value="{!v.selectedLookUpResourcesRecord}" action="{!c.handleSearch}"/>
    <aura:handler name="change" value="{!v.selectedLookUpVehiclesRecord}" action="{!c.handleSearch}"/>
    <aura:handler name="change" value="{!v.selectedLookUpStudentRecord}" action="{!c.handleSearch}"/>
    
    <!-- Attributes to handle accordian-->
    <aura:attribute name="activeSections" type="List" default="[]" />
    <aura:attribute name="new" type="String" default="New" />
    <aura:attribute name="inProgress" type="String" default="Pending Approval" />
    <aura:attribute name="rejected" type="String" default="Rejected" />
    <aura:attribute name="approved" type="String" default="Approved" />
    <aura:attribute name="closed" type="String" default="Closed" />
    <aura:attribute name="status" type="String" default="" />
    
    <aura:attribute name="caseList" type="Case[]" /> 
    <aura:attribute name="currentData" type="Case[]" />
    <!-- Attributes to show detail page modal popup -->
    <aura:attribute name="showRecordDetailModal" type="Boolean" default="false"/>
    <aura:attribute name="recordDetailId" type="String" />
    <aura:attribute name="recordTypeName" type="String" />
    <lightning:overlayLibrary aura:id="overlayLib"/>
     <aura:attribute name="showRecordEditForm" type="Boolean" default="false"/>
    <aura:attribute name="showConfirmDialog" type="boolean" default="false"/>

    
    <aura:attribute name="showEditRecordPage" type="String" default="" />
    <aura:attribute name="showCommentsPage" type="String" default="" />
     <aura:attribute name="showApprovePage" type="String" default="" />
     <aura:attribute name="showRejectPage" type="String" default="" />
     <aura:attribute name="showFineApplicablePage" type="String" default="" />
      <aura:attribute name="finevalue" type="Boolean" />
     <aura:attribute name="comments" type="string" default="" />
     <aura:attribute name="userParentProfileWrap" type="ET_BusinessCommunityController.ResultWrapper" />
     <aura:attribute name="isGovDepartment" type="boolean" default="false" />
     <aura:attribute name="isESETransportation" type="boolean" default="false" />
     <aura:attribute name="isQualityCordinator" type="boolean" default="false" />
     <aura:attribute name="isHSEInspector" type="boolean" default="false" />
     <aura:attribute name="isESEInspector" type="boolean" default="false" />
      <aura:attribute name="isHSETransportationInspector" type="boolean" default="false" />
      <aura:attribute name="isHSEQualityCordinator" type="boolean" default="false" />
    
    
    <c:ET_MOE_LanguageSelectionCmp aura:id="landId" />
    <aura:if isTrue="{!v.newCase}">        
        <!--###### MODAL BOX Start######--> 
        <c:CaseB2BPopupMOE aura:id="CaseB2BPopupMOE" newCase="{!v.newCase}"  showCasePopup="{!v.showCaseTable}"/>             
        <div class="slds-backdrop slds-backdrop_open"></div>    
    </aura:if>
    <div class="casesupmaindiv">
        <div class="menudiv">
            <c:MenuItemsList />
        </div>
      
        <table class="" style="width:100%">
            <tr>
                <th>Government Department</th>
                <th>ESE TranspotaionTeam</th> 
                <th>HSE Inspector</th>
                <th>Team Leader</th>
                <th>HSE Transporation Inspector</th>
                <th>HSE Quality Cordinator</th>
                <th>ESE Transporation Inspector</th>
                 <th>lang</th>
            </tr>
            <tr>
                <td>{!v.isGovDepartment}</td>
                <td>{!v.isESETransportation}</td>
                <td>{!v.isHSEInspector}</td>
                <td>{!v.isTeamLeader}</td>
                <td>{!v.isHSETransportationInspector}</td>
                <td>{!v.isHSEQualityCordinator}</td>
                <td>{!v.isESEInspector}</td>
                 <td>{!v.clLang}</td>
            </tr>
           </table>
        
        <aura:if isTrue="{!v.customerSupportDashboard}">
            <div class="fivediv">
                <article class="slds-card" style="text-align:center;">
                    <a href="" id="newcase" onclick="{!c.handleNewCasesClick}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        <img src="{!$Resource.newcase_img}"/>
                                        {!v.newCases}
                                    </div>
                                    <h3 class="form-title">{!v.clNew}</h3>
                                </div>
                            </div>
                        </div>
                    </a>  
                    <a href="" id="escalatedcase" onclick="{!c.handleApprovalCasesClick}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        <img src="{!$Resource.pandingcase_img}"/>
                                        {!v.escalatedCases}
                                    </div>
                                    <h3 class="form-title">{!v.clInProgress}</h3>
                                </div>
                            </div>
                        </div>
                    </a>
                    <a href="" id="closedcase" onclick="{!c.handleClosedCasesClick}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        <img src="{!$Resource.closecase_img}"/>
                                        {!v.closedCases}
                                    </div>
                                    <h3 class="form-title">{!v.clClosed}</h3>                            
                                </div>
                            </div>
                        </div>
                    </a>
                     <a href="" id="closedcase" onclick="{!c.handleOnHoldCasesClick}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        <img src="{!$Resource.closedCustomerCareIcon}"/>
                                        {!v.onHoldCases}
                                    </div>
                                    <h3 class="form-title">{!v.clRejected}</h3>                            
                                </div>
                            </div>
                        </div>
                    </a>
                    <a href="" id="closedcase" onclick="{!c.handleRequestMoreInfoClick}">
                        <div class="slds-col">
                            <div class="form-box-row2" id="step-1">
                                <div class="rightsectiondiv">
                                    <div class="numberSize">
                                        <img src="{!$Resource.pandingcase_img}"/>
                                        {!v.requestCount}
                                    </div>
                                    <h3 class="form-title">Request More Info</h3>                            
                                </div>
                            </div>
                        </div>
                    </a>
                </article>
            </div>
        </aura:if>
        <aura:if isTrue="{!not(v.isQualityCordinator)}">
        <!--<aura:if isTrue="{!not(v.isESETransportation)}">  </aura:if>-->
            
        <div class="{!v.clLang =='ar' ? 'btncreatesectionar slds-p-right_small slds-p-bottom_medium btncreatesection' : 'slds-p-right_small slds-p-bottom_medium btncreatesection'}">
            <!--  <lightning:button class="emmergencyButton" label="{!v.clCreateRequest}" title="{!v.clCreateRequest}"  onclick="{!c.createCasePopupMoE}" />-->
            <lightning:button class="{!v.clLang =='ar' ? 'emmergencyButtonar emmergencyButton' : 'emmergencyButton'}" label="{!v.clCreateCase}" title="{!v.clCreateCase}"  onclick="{!c.createCasePopup}" />
            <lightning:button class="{!v.clLang =='ar' ? 'emmergencyButtonar emmergencyButton' : 'emmergencyButton'}" label="{!v.clAllRequests}" title="{!v.clAllRequests}" onclick="{!c.showAllCasesAction}"/>
            <lightning:button class="{!v.clLang =='ar' ? 'emmergencyButtonar emmergencyButton' : 'emmergencyButton'}" label="{!v.clDownload}" title="{!v.clDownload}" onclick="{!c.downloadCases}"/>
        </div>
          
        </aura:if>    
        <aura:if isTrue="{!v.showCaseTable}">
            <aura:if isTrue="{!v.caseList.length>0}"> 
                <div style="padding:0px" class="{!v.clLang =='ar' ? 'serchboxtab_AR' : 'serchboxtab'}">
                    <lightning:input type="search"
                                     name="searchKey" value="{!v.searchText}" 
                                     aura:id="searchKey"  onkeyup="{!c.searchRequest}" 
                                     placeholder="{!v.clSearchCase}" />
                </div>
            </aura:if>
            <div class="documentmain animated slideInDown">
                <div class="tableshow">
                    <div class="slds-grid">
                        <div class="slds-col"> 
                            <h3 class="Headingcontent"> {!v.status}</h3>
                            <div class="tableClass">
                                <!--Arabic-->
                                <aura:if  isTrue="{!v.clLang =='ar'}" >
                                    <table class="slds-table slds-table_bordered " width="100%">
                                        <thead>
                                            <tr class="slds-line-height_reset">
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Action">{!v.clAction}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="School Name">{!v.clSchoolName}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Person Name">اسم الشخص</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Recent Activity ">{!v.clRecentActivity}</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Next Actvity">{!v.clNextActivity}</div>
                                                </th>
                                                <th class=""  scope="col">
                                                    <div class="slds-truncate" title="Case Number">{!v.clCaseNumber}</div>
                                                     <lightning:buttonIcon iconName="utility:sort"
                                                                          onclick="{!c.sortData }"
                                                                          alternativeText=""
                                                                          value="CaseNumber"
                                                                          class="btnsorticon"/>
                                                </th>
                                                <th class=""  scope="col">
                                                    <div class="slds-truncate" title="Type">Type</div>
                                                </th>
                                                <th class="" scope="col">
                                                    <div class="slds-truncate" title="Sr.No.">{!v.clSrNo}</div>
                                                   
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <aura:iteration items="{!v.currentData}" var="case" indexVar="index">
                                                <tr class="slds-hint-parent">
                                                   
                                                    <td style="word-wrap: break-word;">
                                                        <aura:if isTrue="{!(v.isGovDepartment &amp;&amp;case.Status_Category__c=='Further information is pending from the requester'&amp;&amp;case.Status=='In Progress'&amp;&amp;case.Sub_Status__c=='Operations Manager sent for more information')}">
                                                                <lightning:button iconName="action:edit"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Update Information"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"/>
                                                                
                                                            </aura:if>
                                                            
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Sub_Status__c=='Information added by the requester' &amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:approval"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="approve"  title="Approve"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Approve"/>
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Status_Category__c=='Pending with HSE Quality Coordinator For Review' &amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:recall"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="redirect"  title="Redirect"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Redirect"/>
                                                               <!-- <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Reject'
                                                                                  class="update"  title="Update"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Update"/>-->
                                                                 <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Status=='In Progress' &amp;&amp; case.Status_Category__c=='Pending with HSE Quality Coordinator'&amp;&amp; case.Sub_Status__c!='Information added by the requester')}">
                                                                <lightning:button iconName="action:approval"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="approve"  title="Approve"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Approve"/>
                                                                <lightning:button iconName="action:close"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Reject'
                                                                                  class="reject"  title="Reject"
                                                                                  onclick="{!c.open_Reject_flag}" 
                                                                                  label="Reject"/>
                                                            </aura:if>
                                                            
                                                            
                                                            <aura:if isTrue="{!(v.isESETransportation &amp;&amp; case.Sub_Status__c=='Solution Provided by Operation Manager'&amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:new"
                                                                                  value="{!case.Id}"
                                                                                  class="addFine"  title="fine Applicable"
                                                                                  onclick="{!c.open_Fine_Page}" 
                                                                                  label="Add Fine"
                                                                                  />
                                                                <lightning:button iconName="action:close"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='No Fine'
                                                                                  class="addFine"  title="No Applicable"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="No Fine"
                                                                                  />
                                                                
                                                                
                                                            </aura:if>
                                                            
                                                            <aura:if isTrue="{!(v.isHSEInspector &amp;&amp; case.Status_Category__c=='Pending with HSE Inspector')}">
                                                                <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />
                                                                
                                                                
                                                            </aura:if>
                                                              <aura:if isTrue="{!(v.isHSETransportationInspector &amp;&amp; case.Status_Category__c=='Pending with HSE Transportation Inspector')}">
                                                                <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />
                                                                
                                                                
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEInspector &amp;&amp; case.Sub_Status__c=='Rejeted by HSE Quality Coordinator')}">
                                                                
                                                                <lightning:button iconName="action:edit"
                                                                                  value="{!case.Id}"
                                                                                  class="EditRecord"  title="Comments"
                                                                                  onclick="{!c.open_edit_Flag}" 
                                                                                  label="Edit"
                                                                                  />
                                                                
                                                                
                                                                
                                                            </aura:if>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!case.School_Name_Acc__r.Name} 
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!case.Driver_Name_1__r.Name}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!case.ESE_Recent_Category__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        {!case.ESE_Next_Category__c}
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                        <a id="{!case.Id}" href="" onclick="{!c.handleCaseClick}">
                                                            {!case.CaseNumber}
                                                        </a>
                                                    </td>
                                                    <td style="word-wrap: break-word;">
                                                 
                                                            {!case.Case_Type_AR__c}
                                                     
                                                    </td>
                                                    
                                                    <td style="word-wrap: break-word;">
                                                        {!index + 1}
                                                    </td>
                                                </tr> 
                                                
                                            </aura:iteration>
                                        </tbody>
                                    </table>
                                    <aura:set attribute="else">
                                        <!--english-->
                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered " width="100%">
                                            <thead>
                                                <tr class="slds-line-height_reset">
                                                    <th class="" scope="col">
                                                        <div class="slds-truncate" title="Sr. No.">{!v.clSrNo}</div>
                                                        <lightning:buttonIcon iconName="utility:sort"
                                                                              onclick="{!c.sortData }"
                                                                              alternativeText=""
                                                                              value="CaseNumber"
                                                                              class="btnsorticon"/>
                                                    </th>
                                                     <th class=""  scope="col">
                                                        <div class="slds-truncate" title="Case Number">Type</div>
                                                    </th>
                                                    <th class=""  scope="col">
                                                        <div class="slds-truncate" title="Case Number">{!v.clCaseNumber}</div>
                                                    </th>
                                                    <th class="" scope="col">
                                                        <div class="slds-truncate" title="Next Actvity">Next Activity </div>
                                                    </th>
                                                    <th class="" scope="col">
                                                        <div class="slds-truncate" title="Recent Activity ">Recent Activity </div>
                                                    </th>
                                                    <th class="" scope="col">
                                                        <div class="slds-truncate" title="Person Name">Person Name</div>
                                                    </th>
                                                    <th class="" scope="col">
                                                        <div class="slds-truncate" title="School Name">School Name</div>
                                                    </th>
                                                     <th class="" scope="col">
                                                        <div class="slds-truncate" title="Action">Action</div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <aura:iteration items="{!v.currentData}" var="case" indexVar="index">
                                                    <tr class="slds-hint-parent">
                                                        <td style="word-wrap: break-word;">
                                                            {!index + 1}
                                                        </td>
                                                         <td style="word-wrap: break-word;">
                                                            <a id="{!case.Id}" href="" onclick="{!c.handleCaseClick}">
                                                                {!case.RecordType.Name}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            <a id="{!case.Id}" href="" onclick="{!c.handleCaseClick}">
                                                                {!case.CaseNumber}
                                                            </a>
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!case.Status_Category__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!case.Sub_Status__c}
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                            {!case.Driver_Name_1__r.Name}
                                                        </td>
                                                        
                                                        <td style="word-wrap: break-word;">
                                                            {!case.School_Name_Acc__r.Name} 
                                                        </td>
                                                        <td style="word-wrap: break-word;">
                                                           <aura:if isTrue="{!(v.isGovDepartment &amp;&amp;case.Status_Category__c=='Further information is pending from the requester'&amp;&amp;case.Status=='In Progress'&amp;&amp;case.Sub_Status__c=='Operations Manager sent for more information')}">
                                                                <lightning:button iconName="action:edit"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Update Information"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"/>
                                                                
                                                            </aura:if>
                                                            
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Sub_Status__c=='Information added by the requester' &amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:approval"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="approve"  title="Approve"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Approve"/>
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Status_Category__c=='Pending with HSE Quality Coordinator For Review' &amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:recall"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="redirect"  title="Redirect"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Redirect"/>
                                                               <!-- <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Reject'
                                                                                  class="update"  title="Update"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Update"/>-->
                                                                 <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEQualityCordinator &amp;&amp; case.Status=='In Progress' &amp;&amp; case.Status_Category__c=='Pending with HSE Quality Coordinator'&amp;&amp; case.Sub_Status__c!='Information added by the requester')}">
                                                                <lightning:button iconName="action:approval"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Approve'
                                                                                  class="approve"  title="Approve"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="Approve"/>
                                                                <lightning:button iconName="action:close"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='Reject'
                                                                                  class="reject"  title="Reject"
                                                                                  onclick="{!c.open_Reject_flag}" 
                                                                                  label="Reject"/>
                                                            </aura:if>
                                                        <aura:if isTrue="{!(v.isESETransportation &amp;&amp; case.Sub_Status__c=='Solution Provided by Operation Coordinator'&amp;&amp;case.Status=='In Progress')}">
                                                                <lightning:button iconName="action:new"
                                                                                  value="{!case.Id}"
                                                                                  class="addFine"  title="fine Applicable"
                                                                                  onclick="{!c.open_Fine_Page}" 
                                                                                  label="Add Fine"
                                                                                  />
                                                                <lightning:button iconName="action:close"
                                                                                  value="{!case.Id}"
                                                                                  aura:id='No Fine'
                                                                                  class="addFine"  title="No Applicable"
                                                                                  onclick="{!c.updateCaseController}" 
                                                                                  label="No Fine"
                                                                                  />
                                                                
                                                                
                                                            </aura:if>
                                                            
                                                            <aura:if isTrue="{!(v.isHSEInspector &amp;&amp; case.Status_Category__c=='Pending with HSE Inspector')}">
                                                                <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />

                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isESEInspector &amp;&amp; case.Status_Category__c=='Pending with ESE Inspector')}">
                                                                <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />

                                                            </aura:if>
                                                              <aura:if isTrue="{!(v.isHSETransportationInspector &amp;&amp; case.Status_Category__c=='Pending with HSE Transportation Inspector')}">
                                                                <lightning:button iconName="action:update_status"
                                                                                  value="{!case.Id}"
                                                                                  class="update"  title="Comments"
                                                                                  onclick="{!c.open_Comment_Update_flag}" 
                                                                                  label="Update Comments"
                                                                                  />
                                                                
                                                                
                                                            </aura:if>
                                                            <aura:if isTrue="{!(v.isHSEInspector &amp;&amp; case.Sub_Status__c=='Rejeted by HSE Quality Coordinator')}">
                                                                
                                                                <lightning:button iconName="action:edit"
                                                                                  value="{!case.Id}"
                                                                                  class="EditRecord"  title="Comments"
                                                                                  onclick="{!c.open_edit_Flag}" 
                                                                                  label="Edit"
                                                                                  />
                                                                
                                                                
                                                                
                                                            </aura:if>
                                                        </td>

                                                    </tr>

                                                </aura:iteration>
                                            </tbody>
                                        </table>
                                    </aura:set>
                                </aura:if>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aura:if>
        
        <aura:if isTrue="{!v.showRecordDetailModal}">
            <c:BusinessCommunityRecordDetailPopup showIFrame="{!v.showRecordDetailModal}"
                                                  recordDetailId="{!v.recordDetailId}"
                                                  recordTypeName="{!v.recordTypeName}"
                                                  objectApiName="{!v.objectApiName}"/>
        </aura:if>
    </div>
   <div class="slds-m-around_xx-large">
    <aura:if isTrue="{!v.showEditRecordPage}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container slds-modal_large">
                <header class="slds-modal__header">  
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Edit Details</h2>
                </header>
                   <div class="slds-modal__content slds-p-around_medium bgImageDiv" id="modal-content-id-1">
                <lightning:recordEditForm objectApiName="Case"
                                          recordId="{!v.recordDetailId}"
                                          aura:id="caseForm"
                                          onload="{!c.handleOnLoad}"
                                          onsubmit="{!c.handleOnSubmit}"
                                          onsuccess="{!c.handleOnSuccess}"
                                          onerror="{!c.handleOnError}">
                    <div class="documentmain">
                        <div class="slds-grid">
                            <div class="slds-col">
                                <div class="slds-tile__detail">
                                    <div class="slds-form-element__control">
                                        <aura:if isTrue="{!v.clLang == 'en'}">
                                            <span class="createReqPopHeading" style="color:#000;float:left;">Driver Name</span><B/>
                                            <lightning:inputField fieldName="Driver_Name__c" class="slds-size_1-of-2 slds-p-around_small"/>
                                            <aura:set attribute="else">
                                                <span class="createReqPopHeading_ar" style="color:#000;float:right">Driver Name Arabic</span><B/>
                                                <lightning:inputField variant="label-hidden" fieldName="Driver_Name__c" value="" class="ar_textbox"  />
                                            </aura:set>
                                        </aura:if>
                                    </div>
                                </div>
                            </div>
                                <div class="slds-col">
                                <div class="slds-tile__detail">
                                    <div class="slds-form-element__control">
                                        <aura:if isTrue="{!v.clLang == 'en'}">
                                            <span class="createReqPopHeading" style="color:#000;float:left;">Fine_Applicable__c</span><B/>
                                            <lightning:inputField fieldName="Fine_Applicable__c" class="slds-size_1-of-2 slds-p-around_small"/>
                                            <aura:set attribute="else">
                                                <span class="createReqPopHeading_ar" style="color:#000;float:right">Fine_Applicable__c Arbic</span><B/>
                                                <lightning:inputField variant="label-hidden" fieldName="Fine_Applicable__c" value="" class="ar_textbox"  />
                                            </aura:set>
                                        </aura:if>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-grid">
                            <div class="slds-col">
                                <div class="slds-tile__detail">
                                    <div class="slds-form-element__control">
                                        <aura:if isTrue="{!v.clLang == 'en'}">
                                            <span class="createReqPopHeading" style="color:#000;float:left;">KPI Number</span><B/>
                                            <lightning:inputField fieldName="KPI_Number__c" class="slds-size_1-of-2 slds-p-around_small"/>
                                            <aura:set attribute="else">
                                                <span class="createReqPopHeading_ar" style="color:#000;float:right">KPI_Number__c Arbic</span><B/>
                                                <lightning:inputField variant="label-hidden" fieldName="KPI_Number__c" value="" class="ar_textbox"  />
                                            </aura:set>
                                        </aura:if>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col">
                                <div class="slds-tile__detail">
                                    <div class="slds-form-element__control">
                                        <aura:if isTrue="{!v.clLang == 'en'}">
                                            <span class="createReqPopHeading" style="color:#000;float:left;">Description</span><B/>
                                            <lightning:inputField fieldName="Description__c" class="slds-size_1-of-2 slds-p-around_small"/>
                                            <aura:set attribute="else">
                                                <span class="createReqPopHeading_ar" style="color:#000;float:right">Description Arbic</span><B/>
                                                <lightning:inputField variant="label-hidden" fieldName="Description__c" value="" class="ar_textbox"  />
                                            </aura:set>
                                        </aura:if>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                        <lightning:messages />
                    <footer class="slds-modal__footer">
                        <aura:if isTrue="{!v.clLang == 'en'}">
                            <lightning:button variant="neutral" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                              onclick="{!c.closeConfirmModal}" class="btn_close" />
                            <lightning:button variant="brand" type="submit" name="save" label="Save" class="slds-m-top_medium"/>
                            <aura:set attribute="else">
                                <lightning:button variant="neutral" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                                  onclick="{!c.closeConfirmModal}" class="btn_close" />
                                <lightning:button variant="brand" type="submit" name="save" label="Save" class="slds-m-top_medium"/>
                            </aura:set>
                        </aura:if>
                        
                    </footer>
                    </lightning:recordEditForm>
                
                </div>
            </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
       </div>

    <div class="slds-m-around_xx-large">
        <aura:if isTrue="{!v.showCommentsPage}">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">  
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Update Comments</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium bgImageDiv" id="modal-content-id-1">
                        <label>
                            Please&nbsp;Add&nbsp;Below &nbsp;Comments</label>
                        <lightning:textarea aura:id="comment" name="comments" label=""
                                            required="{!v.caseCommentsRequired}" messageWhenValueMissing="Complete this field."
                                            value="{!v.comments}" class="commetuser" style="text-align:center;" />
                        
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning:button variant="brand" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                          onclick="{!c.closeConfirmModal}" class="btn_close" />
                        <lightning:button variant="brand" label="Save" title="Update" aura:id="status"
                                          disabled="{!v.isDisabled}" onclick="{!c.handleUpdateCommnets}" class="btnsave" />
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
    </div>
    <div class="slds-m-around_xx-large">
        <aura:if isTrue="{!v.showFineApplicablePage}">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">  
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Fine </h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium bgImageDiv" id="modal-content-id-1">
                        <label> Fine Applicable 
                        </label>
                        <ui:inputCheckbox aura:id="chkbox" class="slds-input" change="{!c.selectChange}"/>
                        <!--<lightning:textarea aura:id="comment" name="comments" label=""
                                            required="{!v.caseCommentsRequired}" messageWhenValueMissing="Complete this field."
                                            value="{!v.comments}" class="commetuser" style="text-align:center;"/>-->
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning:button variant="brand" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                          onclick="{!c.closeConfirmModal}" class="btn_close" />
                        <lightning:button variant="brand" label="Save" title="Save" aura:id="status"
                                          disabled="{!v.isDisabled}" onclick="{!c.handleUpdateCommnets}" class="btnsave" />
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
    </div>
    <div class="slds-m-around_xx-large">
        <aura:if isTrue="{!v.showApprovePage}">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Delete Case</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium bgImageDiv" id="modal-content-id-1">
                        
                        <label>
                            {!v.clDOyouwantto}&nbsp;{!v.status}&nbsp;{!v.clthecase}</label>
                        <lightning:textarea aura:id="comment" name="comments" label=""
                                            required="{!v.caseCommentsRequired}" messageWhenValueMissing="Complete this field."
                                            value="{!v.comments}" class="commetuser" style="text-align:center;" />
                        
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning:button variant="brand" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                          onclick="{!c.closeConfirmModal}" class="btn_close" />
                        <lightning:button variant="brand" label="{!v.clDelete}" title="{!v.clDelete}" aura:id="status"
                                          disabled="{!v.isDisabled}" onclick="{!c.updateCase}" class="btnsave" />
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
    </div>
    <div class="slds-m-around_xx-large">
        <aura:if isTrue="{!v.showRejectPage}">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Reject Case</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium bgImageDiv" id="modal-content-id-1">
                        
                        <label>
                            Add Comments for Reject.</label>
                        <lightning:textarea aura:id="comment" name="comments" label=""
                                            required="{!v.caseCommentsRequired}" messageWhenValueMissing="Complete this field."
                                            value="{!v.comments}" class="commetuser" style="text-align:center;" />
                        
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning:button variant="brand" label="{!v.clCancel}" title="{!v.clCancel}" aura:id="status"
                                          onclick="{!c.closeConfirmModal}" class="btn_close" />
                        <lightning:button variant="brand" label="{!v.clReject}" title="{!v.clReject}" aura:id="status"
                                          disabled="{!v.isDisabled}" onclick="{!c.rejecthandlerCase}" class="btnsave" />
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
    </div>
    
</aura:component>